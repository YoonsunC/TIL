TCP/UDP  
: 전송계층에서 사용하는 프로토콜로써, 목적지 장비까지 전송한 패킷을 상위의 특정 응용 프로토콜에게 전달하는 것에 목적  
: 전송방식 - TCP, UDP  
: 전송계층? 송신자와 수신자를 연결하는 통신 서비스를 제공하는 계층. 데이터의 전달을 담당  

TCP (Transmission Control Protocol)  
: 연결형 서비스를 지원하는 전송 계층 프로토콜. 인터넷 환경에서 기본으로 사용  
: 호스트간 신뢰성 있는 데이터 전달과 흐름제어를 함 -> 인터넷상에서 데이터를 메시지의 형태로 보내기 위해 IP와 함께 사용하는 프로토콜  
: 일반적으로 TCP와 IP를 함께 사용하는데, IP가 데이터의 배달을 처리한다면 TCP는 패킷을 추적 및 관리하게 됨  
: 특징  
 - 연결형 서비스로 가상 회선 방식을 제공  
 - 데이터의 경계를 구분하지 않음  
 - 데이터의 전송 순서 보장  
 - UDP보다 전송속도 느림  
 - 신뢰성 있는 데이터 전송  

UDP (User Datagram Protocol)  
: 비연결형 서비스를 지원하는 전송계층 프로토콜.  
: 인터넷상에서 서로 정보를 주고받을 때 정보를 보낸다는 신호나 받는다는 신호 절차를 거치지 않고, 보내는 쪽에서 일방적으로 데이터를 전달하는 통신 프로토콜  
: 데이터를 데이터그램 단위로 처리하는 프로토콜  
: 데이터그램 ? 독립적인 관계를 지니는 패킷  
: 특징  
 - 비연결형 서비스로 데이터그램 방식 제공  
 - 정보를 주고 받을 때 정보를 보내거나 받는다는 신호절차 거치지 않음  
 - 신뢰성 없는 데이터 전송  
 - 데이터의 경계를 구분  
 - TCP보다 전송속도 빠름  

결론  
: TCP는 연속성보다 신뢰성 있는 전송이 중요할 때에 사용하는 프로토콜  
: UDP는 TCP보다 속도가 빠르며 네트워크 부하가 적다는 장점, but 신뢰성 있는 데이터 전송 보장X  
 -> 신뢰성보다 연속성이 중요한 실시간 서비스(straming)에 자주 사용  

 ----------------------------------------------------------------------------------------------------  
 ## TCP  
 TCP(Transmission Control Protocol) : 높은 신뢰성을 갖고 있으며, 연결의 설정과 해제를 담당하는 프로토콜  
 역할  
 - 데이터를 전송 전 양 종단 간의 연결 설정  
 - 연결 설정 후 가상회선 생성  
 - 데이터그램 연결이 설정된 것을 알리고 연결종료를 통해서 연결을 종료  
 - 패킷이 아닌 전체 메시지를 기다림  
 - 오류 검출 기능과 손상된 프레임의 재전송을 보장  
 특징  
 - 높은 신뢰성  
 - 가상회선 연결 방식  
 - 연결의 설정과 해제  
 - 데이터 체크섬  
 - 시간초과와 재전송  
 - 데이터 흐름 제어  

### TCP 세그먼트 구조  

 출발지 포트 번호(Src Port)  
 발신지 포트 주소(Source Port Address) : 세그먼트를 전송하는 호스트에 있는 응용 프로그램의 포트 번호를 정의하는 16bit의 필드  

 목적지 포트 번호(Dst Port)  
 목적지 포트 주소(Destination Port Address) : 세그먼트를 전송하는 호스트에 있는 응용 프로그램의 포트 번호를 정의하는 16bit의 필드  

 순서 번호(Sequence Number)  
 : SYN플래그가 1인 경우 : 세그먼트에 포함된 데이터의 첫 번째 바이트에 부여된 번호를 나타냄  
 : SYN플래그가 0인 경우 : 세그먼트 데이터의 최초 바이트 값의 누적 시퀀스 번호  

 확인 번호(acknowledgement Number) : 32비트를 가지는 이 확인번호는 세그먼트를 수신한 수신 노드가 상대편 노드로부터 수신하고자 하는 바이트의 번호를 정의한다.  

 헤더길이(Length) : 이 필드의 값은 4바이트 워드 개수로 나타냄. 따라서 값은 5(5x4=20) ~ 15(15x4=60)으로 제한  
 예약(Reserved) : 추후 사용을 위해 예약된 6bit의 공간으로 항상 0으로 설정  

 플래그 UAPRSF  
 - URG(Urgent) : Urgent Pointer 유효여부, Urgent pointer란 전송하는 데이터중 긴급히 전달해야 할 내용이 있을 경우에 사용  
 - PSH(Push) : 대화형 트래픽에 사용되는 것으로 버퍼가 채워지기를 기다리지 않고 데이터를 전달  
 - SYN(Synchronization) : 세션을 설정하는 데에 사용되며 초기에 시퀀스 번호를 보내고, 시퀀스 번호는 임의적으로 생성하여 보냄  
 - ACK(Acknowledgement) : 받는 사람이 보낸 사람 시퀀스 번호에 TCP 계층에서 길이 또는 데이터 양을 더한 것과 같은 ACK를 보냄  
 - RST(Reset) : 재설정(Reset)을 하는 과정이며 양방향에서 동시에 일어나는 종단작업, 비정상적인 세션 연결 끊기에 해당  
 - FIN(Finish) : 세션을 종료시키는 데에 사용되며 보낸 사람이 더이상 보낸 데이터가 없음을 보여줌  

 Windows size : 길이가 16bit이기 때문에 최대 65,535Byte. 윈도우의 크기는 rwnd라고 하며, 수신측에 의해서 결정되기 때문에 송신측은 수신측의 지시에 따라야 함  

 검사합(Checksum) : TCP의 검사합은 필수사항, 실제 헤더 외에도 의사헤더(Pseudo Header)를 포함시켜 전송함  

 긴급 포인트(Urgent Pointer) : 긴급 플래그(Urgent Flag)가 1로 설정되어 있는 경우에만 유효한 16비트 필드  

 Pseudo Header : 실제 헤더 이외의 발신 및 수신 IP 주소 및 프로토콜 등을 추가하여 검사합(Checksum)을 계산  
 검사합 계산 대상 : (가상헤더 + 실제헤더 + 데이터 + Padding)  

 ## 3-Way Handshake  
 TCP/IP 프로토콜을 이용하여 통신하는 응용프로그램이 데이터 전송 전에 정확한 전송을 보장하기 위해 상대 시스템과 세션을 수립하는 과정  
 연결과정  
 - TCP의 연결은 서로의 세션을 보장하기 위해서 Sequence Number와 ACK Number의 값 활용  
 - Sequence 번호의 경우 현재 송신자가 현재 세션의 기준으로 보내는 순서를 의미  
 - ACK 번호의 경우 현재의 송신자가 처리한 결과 또는 연결된 세션임을 구분하는 값을 의미  
 연결과정의 예  
 - 클라이언트가 SYN 플래그 패킷이 송신되었을 때 Sequence 번호는 임의로 지정한 숫자를 포함하여 송신  
 - 서버는 SYN/ACK 플래그를 보내게 되며 클라이언트의 Sequence 번호를 처리한 1을 더하여 ACK 번호를 보내게 되며, 반대로 SYN 플래그에 대응하는 임의의 Sequence 번호를 부여하여 클라이언트에게 전송  
 - 클라이언트는 SYN 플래그에 대응하는 Sequence 번호의 1 더한 값을 ACK 번호로 하여 전송  
 - 만약 1더한 값에 해당하지 않은 값이 오거나 응답이 오지 않는다면 그 값이 오도록 하기 위해 재요청 패킷을 보내며 정상 데이터가 올때까지 기다리면서 신뢰성을 보장  

 ## UDP  
 UDP(User Datagram Protocol)은 신뢰성이 없으며, 수신된 데이터의 무결성을 보장받지 못하지만, 네트워크에 부하를 걸지 않는 장점이 있는 프로토콜  
 상대방이 보낸 응답을 확인하지 않음  
 송신 시스템이 전송하는 데이터에 대한 목적지 시스템의 확인절차가 생략  
 네트워크에 부하를 걸지 않는 장점  
 데이터 자체의 신뢰성이 없음  
 수신된 데이터의 무결성을 보장받지 못함  

## 정리  
TCP  
- 애플리케이션이 네트워크 계층 문제점을 걱정하지 않고 데이터를 안정적으로 송신할 수 있도록 하는, 풍부한 기능의 프로토콜  
- 연결형. 전송 전에 연결을 먼저 맺어야 함  
- 애플리케이션의 데이터 입력 인터페이스 : 스트림 기반. 애플리케이션은 특정한 구조 없이 데이터를 송신함  
- 메시지 전송을 신뢰할 수 있음. 모든 데이터에 대한 승인이 있음  
- 모든 데이터 전송을 관리하며, 손실된 데이터는 자동으로 재전송함  
- 슬라이딩 윈도우를 이용한 흐름 제어를 함. 윈도우 크기를 적절히 조정하고, 혼합 회피 알고리즘을 사용함  
- 부하가 낮지만 UDP보다는 높음  
- 전송속도 빠르지만 UDP만큼은 아님  
- 소형에서 초대형 데이터까지(최대 수 기가바이트)가 적합한 데이터 양  
- 프로토콜을 사용하는 애플리케이션의 유형 : 신뢰할 수 있는 방법으로 데이터를 송신해야 하는 대부분의 프로토콜과 애플리케이션 대부분의 파일/메시지 전송 프로토콜을 포함함  
- 유명 애플리케이션과 프로토콜 : FTP, TELNET, SMTP, DNS, HTTP, POP, NNTP, IMAP, BGP, IRC, NFS(나중버전)  

UDP  
- 단순하고, 빠르며, 애플리케이션이 네트워크 계층에 접근할 수 있도록 하는 인터페이스만 제공할 뿐 다른것은 거의 하지 않음  
- 비연결형, 연결 수립이 없이 데이터를 송신함  
- 애플리케이션의 메시지 입력 인터페이스 : 메시지 기반. 애플리케이션은 데이터를 별도의 패키지로 송신함  
- 신뢰성이 없음. 승인이 없는 최선 노력 전송 방식  
- 재전송 수행하지 않음. 애플리케이션은 손실 데이터를 탐지하고 필요할 경우 재전송해야함  
- 데이터흐름 관리기능 없음  
- 부하 매우낮음  
- 전송속도 매우빠름  
- 소형에서 중형 데이터(최대 수백 바이트)가 적합한 데이터 양  
- 프로토콜을 사용하는 애플리케이션의 유형 : 데이터의 완전성보다 전달 속도가 중요하고, 소량의 데이터를 송신하고, 멀티캐스트/브로드캐스트로 사용하는 애플리케이션  
- 유명 애플리케이션과 프로토콜 : 멀티미디어 애플리케이션, DNS, BOOTP, DHCP, TFTP, SNMP, RIP, NFS(초기버전)  